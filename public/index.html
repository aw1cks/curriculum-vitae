<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Alex Wicks - Curriculum Vitae</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      background-color: #2e2e2e;
      overflow: auto; /* Allow scrolling */
    }

    .pdf-container {
      width: 100%;
      min-height: 100vh;
      padding: 1rem;
      text-align: center; /* Center canvas */
    }

    #pdfCanvas {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
      background: white;
      display: inline-block; /* Needed for text-align:center to work */
    }

    .loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #ccc;
      font-size: 1rem;
      text-align: center;
    }

    .spinner {
      border: 3px solid #4a4a4a;
      border-top: 3px solid #0E508D;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 1rem;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .error {
      display: none;
      padding: 2rem;
      text-align: center;
      color: #ff6b6b;
    }

    .error.show {
      display: block;
    }

    .error a {
      display: inline-block;
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      background: #0E508D;
      color: white;
      text-decoration: none;
      border-radius: 6px;
    }

    #zoom-controls {
      position: fixed;
      bottom: 1.5rem;
      right: 1.5rem;
      z-index: 100;
      display: flex;
      gap: 0.5rem;
    }

    #zoom-controls button {
      width: 44px;
      height: 44px;
      font-size: 1.8rem;
      line-height: 44px;
      background-color: #0E508D;
      color: white;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
      transition: background-color 0.2s;
      user-select: none;
    }

    #zoom-controls button:hover {
      background-color: #1472c4;
    }

    @media (max-width: 768px) {
      .pdf-container {
        padding: 0.5rem;
      }
      #zoom-controls {
        bottom: 1rem;
        right: 1rem;
      }
    }
  </style>
</head>
<body>
  <div class="pdf-container">
    <div class="loading" id="loading">
      <div class="spinner"></div>
      Loading CV...
    </div>
    
    <canvas id="pdfCanvas"></canvas>

    <div class="error" id="error">
      <h2>Unable to load PDF</h2>
      <p style="margin: 1rem 0;">There was an error loading the CV.</p>
      <a href="cv.pdf" download="Alex_Wicks_CV.pdf">Download PDF Instead</a>
    </div>
  </div>

  <div id="zoom-controls">
    <button id="zoom-out" title="Zoom Out">-</button>
    <button id="zoom-in" title="Zoom In">+</button>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
    // Configure PDF.js worker
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

    const canvas = document.getElementById('pdfCanvas');
    const ctx = canvas.getContext('2d');
    const loadingDiv = document.getElementById('loading');
    const errorDiv = document.getElementById('error');

    let pdfDoc = null;
    let pageNum = 1;
    let scale = 1.0;
    let pageIsRendering = false;
    let pageNumIsPending = null;

    function hideLoading() {
      loadingDiv.style.display = 'none';
    }

    function showError() {
      hideLoading();
      errorDiv.classList.add('show');
    }

    function renderPage(num) {
      pageIsRendering = true;
      
      pdfDoc.getPage(num).then(page => {
        const viewport = page.getViewport({ scale: scale });
        const outputScale = window.devicePixelRatio || 1;

        canvas.width = Math.floor(viewport.width * outputScale);
        canvas.height = Math.floor(viewport.height * outputScale);
        
        canvas.style.width = `${Math.floor(viewport.width)}px`;
        canvas.style.height = `${Math.floor(viewport.height)}px`;

        const transform = outputScale !== 1 ? [outputScale, 0, 0, outputScale, 0, 0] : null;

        const renderContext = {
          canvasContext: ctx,
          viewport: viewport,
          transform: transform
        };

        const renderTask = page.render(renderContext);
        
        renderTask.promise.then(() => {
          pageIsRendering = false;
          hideLoading();

          if (pageNumIsPending !== null) {
            renderPage(pageNumIsPending);
            pageNumIsPending = null;
          }
        });
      });
    }

    function queueRenderPage(num) {
      if (pageIsRendering) {
        pageNumIsPending = num;
      } else {
        renderPage(num);
      }
    }

    function onZoomIn() {
      scale += 0.2;
      queueRenderPage(pageNum);
    }

    function onZoomOut() {
      if (scale <= 0.4) { // Set a minimum scale
        return;
      }
      scale -= 0.2;
      queueRenderPage(pageNum);
    }

    document.getElementById('zoom-in').addEventListener('click', onZoomIn);
    document.getElementById('zoom-out').addEventListener('click', onZoomOut);

    // Load the document
    pdfjsLib.getDocument('cv.pdf').promise.then(pdf => {
      pdfDoc = pdf;
      
      // Initial render: calculate scale to fit the whole page
      pdf.getPage(1).then(page => {
          const container = document.querySelector('.pdf-container');
          const style = getComputedStyle(container);
          const paddingX = parseFloat(style.paddingLeft) + parseFloat(style.paddingRight);
          const paddingY = parseFloat(style.paddingTop) + parseFloat(style.paddingBottom);

          const availableWidth = container.clientWidth - paddingX;
          const availableHeight = window.innerHeight - paddingY;

          const viewport = page.getViewport({ scale: 1 });
          
          const scaleWidth = availableWidth / viewport.width;
          const scaleHeight = availableHeight / viewport.height;
          
          scale = Math.min(scaleWidth, scaleHeight);
          queueRenderPage(pageNum);
      });

    }).catch(error => {
      console.error('Error loading PDF:', error);
      showError();
    });
  </script>
</body>
</html>